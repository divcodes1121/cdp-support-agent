{
  "url": "https://docs.lytics.com/docs/client-server-side-cookie-deep-dive",
  "title": "Client & Server Side Cookies",
  "content": "Quick Start Developer Quickstart1. Install the Lytics Tag2. Content Setup3. Surface Personalized MessageBuilding ProfilesDefault AttributesDefault SegmentsGuides & InspirationLead CaptureContent Recommendations 1. Install the Lytics Tag 2. Content Setup 3. Surface Personalized Message Building ProfilesDefault AttributesDefault Segments Default Attributes Default Segments Guides & InspirationLead CaptureContent Recommendations Lead Capture Content Recommendations Account Management What is Vault? Accessing Accounts Monitoring Metrics and AlertsJob AlertsMonitoring Audit LogsExporting Audit Logs or Alert JobsMonitoring MetricsUsage Metrics Job Alerts Monitoring Audit LogsExporting Audit Logs or Alert Jobs Exporting Audit Logs or Alert Jobs Monitoring Metrics Usage Metrics Managing UsersSingle Sign-On Single Sign-On Account SettingsAccount DetailsJavaScript Tag ConfigPersonalization APIContent ServicesSecurityAI & Modeling ControlsSchema Controls Account Details JavaScript Tag Config Personalization API Content Services Security AI & Modeling Controls Schema Controls Data PoliciesPlatform LimitsPrivacy and Data ProtectionImpact of Browser Tracking Changes Platform Limits Privacy and Data Protection Impact of Browser Tracking Changes Compliance Authorizations Access Tokens Key Concepts Identity Resolution Consent & PrivacyComplying with the Digital Markets Act (DMA) Complying with the Digital Markets Act (DMA) Client & Server Side Cookies Content AffinityContent CurationTopic Taxonomy Content Curation Topic Taxonomy ArchitectureIntegration PatternsJob ProcessingLytics Platform Data Flow and AccessCDI and CDP Implementation StrategyLytics Zero Copy with Cloud Connect Integration Patterns Job Processing Lytics Platform Data Flow and Access CDI and CDP Implementation Strategy Lytics Zero Copy with Cloud Connect Pipeline & Profiles Data PipelineJobs (Data Sources and Exports)Data StreamsStream Routing APITemplatesCreating Templates Using the UICreating Templates using Lytics APIUsing the Jsonnet LibraryTemplate Examples Jobs (Data Sources and Exports) Data Streams Stream Routing API TemplatesCreating Templates Using the UICreating Templates using Lytics APIUsing the Jsonnet LibraryTemplate Examples Creating Templates Using the UI Creating Templates using Lytics API Using the Jsonnet Library Template Examples Schema ManagementFields & MappingsAdvanced Mapping FunctionsMeta FieldsQueries & LQLIdentity Key RanksSchema VersionsPlanning & TroubleshootingLytics Profile SchemaSchema Copilot Fields & Mappings Advanced Mapping Functions Meta Fields Queries & LQL Identity Key Ranks Schema Versions Planning & Troubleshooting Lytics Profile Schema Schema Copilot IdentityMerge StatisticsIdentity ExplorerIdentity Rules Merge Statistics Identity Explorer Identity Rules Warehouse Access What is Cloud Connect? Connecting Warehouses Data Models & Queries Activating Data Models Cloud Connect Troubleshooting and FAQs Audiences & Activation User ProfilesUnderstanding Profile HealthFinding a User Understanding Profile Health Finding a User AudiencesAudience GroupsPrebuilt Audiences Audience Groups Prebuilt Audiences ReportsWhat are Reports?ComponentsManaging ReportsDashboard Report What are Reports? Components Managing Reports Dashboard Report ContentTopics & AffinitiesTopicsAffinitiesUsing Topics & AffinitiesClassificationEnrichmentRecommendationsDocumentsContent CollectionsCreating Content CollectionsViewing, Using & Managing CollectionsInterest EnginesDefault Interest EngineCustom Interest EnginesCollaborative Filters Topics & AffinitiesTopicsAffinitiesUsing Topics & Affinities Topics Affinities Using Topics & Affinities Classification Enrichment Recommendations Documents Content CollectionsCreating Content CollectionsViewing, Using & Managing Collections Creating Content Collections Viewing, Using & Managing Collections Interest EnginesDefault Interest EngineCustom Interest EnginesCollaborative Filters Default Interest Engine Custom Interest Engines Collaborative Filters Lookalike Models & AudiencesGetting StartedBuilding Lookalike ModelsEvaluating Lookalike ModelsCreating Lookalike AudiencesImproving Lookalike Models Getting Started Building Lookalike Models Evaluating Lookalike Models Creating Lookalike Audiences Improving Lookalike Models ActivationDestinationsGoalsExperiences Destinations Goals Experiences Behavioral Scores Tutorials Leveraging User ProfilesAccessing Profiles Client SideAccessing Profiles Server SideWorking with Anonymous ProfilesGet Started with Lytics SegmentsInline Content Recommendations Accessing Profiles Client Side Accessing Profiles Server Side Working with Anonymous Profiles Get Started with Lytics Segments Inline Content Recommendations Data Collection & OnboardingWorking with Custom DataWorking with Web DataCollect Mobile Data with Firebase + GTM Working with Custom Data Working with Web Data Collect Mobile Data with Firebase + GTM Data ManagementProfile Stitching Best PracticesMigrating from Queries to Conductor SchemaLQL & Data Import Basics Profile Stitching Best Practices Migrating from Queries to Conductor Schema LQL & Data Import Basics Use CasesAcquire New Customers with LyticsBest Practices for Personalizing Your Ad or Search Landing PageCapture More Information from Qualified LeadsContent Modularization in Email with Lytics AudiencesCustomize your Web Experiences with Branded ImagesDeliver Targeted ContentDrive Email Capture & Engagement with ContentDrive Mobile App Downloads With LyticsEngage Qualified Users with Targeted AdsEnhance Personalized Messaging with User Profile FieldsGrow Your Email Marketing ListImport an Audience from your Data WarehouseImprove Ad Campaign Metrics with Predictive TargetingIncrease Conversions with Lytics and Facebook LookalikeKeep Visitors Engaged with Content Recommendation ExperiencesLeverage Lookalike Models and Predictive AudiencesLookalike Models: Conserve marketing spend on engaged usersLookalike Models: Convert anonymous users to known usersLookalike Models: Convert single purchasers to multi-purchasersLookalike Models: Determine which subscribers are likely to churnMobile Messaging with Lytics Webhooks and Serverless FunctionsOptimize Remarketing SpendPersonalize the Messaging of your Website Based on AudiencePopulate Your Website With One-to-One Content RecommendationsPromote Relevant Content to Users based on their InterestsReach the Right People Using LyticsRetain Existing Customers With LyticsPersonalize your Iterable emails With Lytics content recommendationsBuild a Custom Personalized Experience With Video ContentUnlock Additional Web Personalization Features with Lytics API OverridesHow to Use GTM Tags to Modify Lytics Pathfora Widget BehaviorStyle your Lytics Web Experiences to Fit Your Brand Guidelines Acquire New Customers with Lytics Best Practices for Personalizing Your Ad or Search Landing Page Capture More Information from Qualified Leads Content Modularization in Email with Lytics Audiences Customize your Web Experiences with Branded Images Deliver Targeted Content Drive Email Capture & Engagement with Content Drive Mobile App Downloads With Lytics Engage Qualified Users with Targeted Ads Enhance Personalized Messaging with User Profile Fields Grow Your Email Marketing List Import an Audience from your Data Warehouse Improve Ad Campaign Metrics with Predictive Targeting Increase Conversions with Lytics and Facebook Lookalike Keep Visitors Engaged with Content Recommendation Experiences Leverage Lookalike Models and Predictive Audiences Lookalike Models: Conserve marketing spend on engaged users Lookalike Models: Convert anonymous users to known users Lookalike Models: Convert single purchasers to multi-purchasers Lookalike Models: Determine which subscribers are likely to churn Mobile Messaging with Lytics Webhooks and Serverless Functions Optimize Remarketing Spend Personalize the Messaging of your Website Based on Audience Populate Your Website With One-to-One Content Recommendations Promote Relevant Content to Users based on their Interests Reach the Right People Using Lytics Retain Existing Customers With Lytics Personalize your Iterable emails With Lytics content recommendations Build a Custom Personalized Experience With Video Content Unlock Additional Web Personalization Features with Lytics API Overrides How to Use GTM Tags to Modify Lytics Pathfora Widget Behavior Style your Lytics Web Experiences to Fit Your Brand Guidelines SDKs & Tools WebJavaScriptOn-site PersonalizationSubresource Integrity (SRI) JavaScript On-site Personalization Subresource Integrity (SRI) MobileiOSReact NativeAndroid iOS React Native Android Chrome Extension Integrations Lytics Integration Options Acoustic Adobe AdRoll Airship Amplitude Amazon Ads Amazon Kinesis Amazon Pinpoint Amazon Redshift Amazon S3 Amazon SQS Ansira BigCommerce BlueKai Blueshift Braze Brevo Campaign Monitor Cheetah Digital Clearbit Contentful Cordial Criteo Customer.io Databricks Dotdigital Drift Episerver FullContact GIGYA Google Optimize Google Ad Manager (DFP) Google Ads Google BigQuery Google Cloud Pub/Sub Google Cloud Storage Google Drive Google Marketing: Analytics, DV360, CM360 Google Cloud Operations Google Tag Manager HubSpot iContact Insider Iterable Jebbit Klaviyo Leadsquared LinkedIn LiveRamp Localytics Looker Lotame Lytics File Service Lytics Monitoring Mailchimp Mailgun Mandrill Mapp Mapp: BlueHornet Marketo Maropost MediaMath Meta Microsoft Microsoft Azure Microsoft Teams Mixpanel NetSuite New Relic Omeda OneSignal OneTrust Oracle Marketing Cloud: Eloqua Pinterest PostUp Radar Reddit Responsys Retention Science Sailthru Salesforce Salesforce DMP (Krux) Salesforce Marketing Cloud Salesforce Pardot Segment.com Selligent SendGrid Shopify Sitecore Slack Snapchat Snowflake SparkPost SurveyMonkey Swrve Taboola Tealium TikTok The Trade Desk Unified ID 2.0 Versium Webhooks Webhook Templates Wistia X Ads Yahoo Ads Zapier Zendesk Zuora Contentstack Partners Partner Types Lytics Communication Legacy Insights Importing External Experiences IDP-initiated SSO (legacy) Web PersonalizationIntroductionDrive Traffic CampaignCollect Leads CampaignPresent a Message CampaignRecommend Content CampaignCampaign ReportingCampaign ManagementBuilding Audiences with Campaign Data Introduction Drive Traffic Campaign Collect Leads Campaign Present a Message Campaign Recommend Content Campaign Campaign Reporting Campaign Management Building Audiences with Campaign Data Client & Server Side Cookies Everything you wanted to know about cookies from client side to server side. What is a Cookie An HTTP cookie (web cookie, browser cookie) is a small piece of data that a server sends to a user's web browser. The browser may store the cookie and send it back to the same server with later requests. Typically, an HTTP cookie is used to tell if two requests come from the same browser—keeping a user logged in, for example. It remembers stateful information for the stateless HTTP protocol. Cookie Flavors First-party First-party cookies are created by the host domain – the domain the user is visiting. These cookies are generally considered good; they help provide a better user experience and keep the session open. This means the browser can remember key information, such as items you add to shopping carts, username, and language preferences. Third-party Third-party cookies are those created by domains other than the one the user is visiting at the time and are mainly used for tracking and online-advertising purposes. They also allow website owners to provide certain services, such as live chats. Common Cookie Use Cases Session management Logins, shopping carts, game scores, or anything else the server should remember. Personalization User preferences, themes, and other settings. Tracking Recording and analyzing user behavior. How does Lytics use cookies? Cookies are one of the preferred methods for maintaining a user identifier in the browser, both known and anonymous. This gets associated with all inbound events captured by our Javascript tag as they interact with customer websites. Specifically, our Javascript tag stores a string of digits and characters that are used as a unique ID commonly referred to as our _uid or, in some cases seerid as a first-party cookie. Creating & Managing Cookies Where do cookies come from? Client-Side In web development, the client-side refers to everything in a web application displayed on the client (end-user device). This includes what the user sees, such as text, images, and the rest of the UI, along with any actions an application performs within the user's browser. When someone refers to a “client-side cookie,” they are generally referring to a cookie that is created and/or managed via a common client-side programming language such as Javascript. Server Side Like with client-side, server-side means everything that happens on the server instead of on the client. In the past, nearly all business logic ran on the server-side, including rendering dynamic webpages, interacting with databases, identity authentication, and push notifications. When someone refers to a “server-side cookie,” they are generally referring to a cookie that is created and managed using one of the many common server-side programming languages such as NodeJS, PHP, Python, etc. Cookie Ingredients Name Defines the cookie name. Generally, the cookie name is the primary way of retrieving a cookie and its associated value and attributes. Value The stored value for the cookie. This can include any US-ASCII character excluding a control character, whitespace, double quotes, comma, semicolon, and backslash. Expires Indicates the maximum lifetime of the cookie as an HTTP-date timestamp. See Date for the required formatting. Max-Age Indicates the number of seconds until the cookie expires. A zero or negative number will expire the cookie immediately. Domain Defines the host to which the cookie will be sent. Path Indicates the path that must exist in the requested URL for the browser to send the Cookie header. Secure This indicates that the cookie is sent to the server only when a request is made with the HTTPS: scheme (except on localhost) and, therefore, is more resistant to man-in-the-middle attacks. HttpOnly Forbids JavaScript from accessing the cookie, for example, through the Document.cookie property. Note that a cookie created with HttpOnly will still be sent with JavaScript-initiated requests, for example, when calling XMLHttpRequest.send() or fetch(). This mitigates attacks against cross-site scripting (XSS). SameSite Controls whether or not a cookie is sent with cross-origin requests, providing some protection against cross-site request forgery attacks (CSRF). Who’s taking away my cookies?!? In June 2017, Apple introduced a new privacy feature called Intelligent Tracking Prevention (ITP). This same feature was officially released in September 2017 with Safari 12 and iOS 11. Since then, the ITP has evolved and introduced several subsequent versions leading us to the current state (as of July 2022), which has many impacts on marketing but most notably: ITP blocks all third-party cookies by default. (ITP 1.0/1.1) ITP can grant exceptions to third-party cookies with Storage API. (ITP 2.0) ITP caps all first-party cookies set with JavaScript to 7 days or 24 hours. (ITP 2.1/2.2) ITP caps first-party cookies set by the server using CNAME cloaking to 7 days. (ITP 2.3) As a result of the privacy and security efforts in general other browsers such as Mozilla’s Firefox(ETP) and Google Chrome have followed suit in announcing and/or implementing their security and tracking protocols, which continue to impact tools such as third and first-party cookies that have long been a staple in providing the data necessary for marketers to personalize their communications effectively. What can I do to replace my cookies? With each iteration on more stringent privacy-related changes comes a wave of workarounds or alternate approaches to maintaining access to behavioral data essential to marketing: 1. Deploy a strong first-party identification strategy. There is no replacement then a strong identification strategy. Creating a relationship in which a user will openly share their identity through a login or some other authenticated means will always result in the highest level of certainty on identity, which leads to the best level of personalization. However, many use cases focus on anonymous users or users who have not built up the relationship necessary to unlock this level of authentication. 2. First-party client-side cookies have changed but are still a viable solution. Though third-party cookies are effectively dead, first-party cookies are still viable for many use cases. Not only do they offer a very simple off-the-shelf type of implementation for leveraging, they also have a long shelf life, assuming that an anonymous user interacts frequently enough to overcome the 7-day expiration window. 3. First-party server-side cookies offer an extended expiration window. Over the past 12 months, there has been a surge of interest in server-side cookies. This method for setting cookies currently is not affected by the ITP changes that impact client-side cookies, most notably the automatic expiration at seven days. Rather, server-side cookies can live for long periods, leading to a higher quality identification for anonymous users. The downside, however, is they are far more difficult to leverage than the client-side. They require a much more technical integration with whatever server-side technology is used to power the web asset and may not be accessible in the same manner as client-side cookies. Getting Technical with Server Side Cookies In general, regardless of the specific attribute settings used when leveraging server-side cookies, they currently are not impacted by the 7-day expiration window that client-side cookies fall victim to. However, Apple has made it clear that they have additional plans to extend some of the client-side cookie limitations to the server-side, and the most important attribute in that discussion is the HttpOnly attribute. https://webkit.org/blog/9521/intelligent-tracking-prevention-2-3/ As a CDP and technology leader, we always aim to help our customers future-proof their implementations. As such, even though a non-HttpOnly server-side cookie offers an easier means to bypass current client-side restrictions, it is our recommendation to consider investing to leverage HttpOnly cookies set by the server-side to prevent any potential impacts of the next few iterations of ITP. Below we’ll explore the two options and demonstrate the key differences. Server Side Cookie without HttpOnly The following example in Node.js demonstrates a sample snippet for setting the cookie server side. Most server-side languages have existing methods to make this very easy. In the case of creating a cookie for Lytics to leverage, you will also need to generate a unique ID which can be done in a variety of ways. In the case of Node, you may consider using the randomUUID() method of the Crypto interface. A simple Google search can lead you or your developer down the road of generating a unique ID that best fits your use case. Once you have that unique ID, you simply set the cookie using the pre-defined Lytics name our Javascript tag is looking for. Alternatively, the tag can be configured to use any custom name. Since non-HttpOnly cookies are accessible out of the box client-side there is no additional lift necessary. Our tag will pick up the cookie and use that ID as the identifier. It is important to note that any UID changes must also be managed server-side as setting the cookie client-side will engage the 7-day expiration max. In this example, we simply raise an alert with the cookie string and do not show the actual implementation of the Lytics tag. Server Side Cookie with HttpOnly Setting HttpOnly to true comes with an additional level of complexity but benefits from following the stringent and recommended guidelines of Apple ITP, which in theory will go farther in the way of future-proofing. Much like the above example, we’ll set a cookie, in this case using Node, in the same way. The only difference here is setting httpOnly to true. This means that the cookie is secure but will no longer be accessible out of the box by Javascript. Rather, you’ll have to implement an alternative method for surfacing that ID to Javascript so that it can be passed to the Lytics Javascript tag and used during collection/resolution. All code examples in this document are purely for demonstration. Any customer facing implementation should follow the guidance of our customer facing technical teams and the technical experts on our customer’s end. These examples in production represent HIGH risk as documented. Updated about 1 year ago Table of Contents What is a Cookie Cookie Flavors Common Cookie Use Cases How does Lytics use cookies? Creating & Managing Cookies Who’s taking away my cookies?!? What can I do to replace my cookies? Getting Technical with Server Side Cookies What is a Cookie Cookie Flavors Common Cookie Use Cases How does Lytics use cookies? Creating & Managing Cookies Who’s taking away my cookies?!? What can I do to replace my cookies? Getting Technical with Server Side Cookies Cookie Flavors Common Cookie Use Cases How does Lytics use cookies? Creating & Managing Cookies Who’s taking away my cookies?!? What can I do to replace my cookies? Getting Technical with Server Side Cookies",
  "headings": [
    {
      "level": 2,
      "text": "Quick Start"
    },
    {
      "level": 2,
      "text": "Account Management"
    },
    {
      "level": 2,
      "text": "Key Concepts"
    },
    {
      "level": 2,
      "text": "Pipeline & Profiles"
    },
    {
      "level": 2,
      "text": "Warehouse Access"
    },
    {
      "level": 2,
      "text": "Audiences & Activation"
    },
    {
      "level": 2,
      "text": "Tutorials"
    },
    {
      "level": 2,
      "text": "SDKs & Tools"
    },
    {
      "level": 2,
      "text": "Integrations"
    },
    {
      "level": 2,
      "text": "Partners"
    },
    {
      "level": 2,
      "text": "Legacy"
    },
    {
      "level": 1,
      "text": "Client & Server Side Cookies"
    },
    {
      "level": 1,
      "text": "What is a Cookie"
    },
    {
      "level": 2,
      "text": "Cookie Flavors"
    },
    {
      "level": 3,
      "text": "First-party"
    },
    {
      "level": 3,
      "text": "Third-party"
    },
    {
      "level": 2,
      "text": "Common Cookie Use Cases"
    },
    {
      "level": 3,
      "text": "Session management"
    },
    {
      "level": 3,
      "text": "Personalization"
    },
    {
      "level": 3,
      "text": "Tracking"
    },
    {
      "level": 2,
      "text": "How does Lytics use cookies?"
    },
    {
      "level": 2,
      "text": "Creating & Managing Cookies"
    },
    {
      "level": 3,
      "text": "Where do cookies come from?"
    },
    {
      "level": 4,
      "text": "Client-Side"
    },
    {
      "level": 4,
      "text": "Server Side"
    },
    {
      "level": 3,
      "text": "Cookie Ingredients"
    },
    {
      "level": 4,
      "text": "Name"
    },
    {
      "level": 4,
      "text": "Value"
    },
    {
      "level": 4,
      "text": "Expires"
    },
    {
      "level": 4,
      "text": "Max-Age"
    },
    {
      "level": 4,
      "text": "Domain"
    },
    {
      "level": 4,
      "text": "Path"
    },
    {
      "level": 4,
      "text": "Secure"
    },
    {
      "level": 4,
      "text": "HttpOnly"
    },
    {
      "level": 4,
      "text": "SameSite"
    },
    {
      "level": 2,
      "text": "Who’s taking away my cookies?!?"
    },
    {
      "level": 2,
      "text": "What can I do to replace my cookies?"
    },
    {
      "level": 3,
      "text": "1. Deploy a strong first-party identification strategy."
    },
    {
      "level": 3,
      "text": "2. First-party client-side cookies have changed but are still a viable solution."
    },
    {
      "level": 3,
      "text": "3. First-party server-side cookies offer an extended expiration window."
    },
    {
      "level": 2,
      "text": "Getting Technical with Server Side Cookies"
    },
    {
      "level": 3,
      "text": "Server Side Cookie without HttpOnly"
    },
    {
      "level": 3,
      "text": "Server Side Cookie with HttpOnly"
    }
  ],
  "platform": "lytics"
}